#------------------------------------------------------------------------------#
#  DFTB+: general package for performing fast atomistic simulations            #
#  Copyright (C) 2017  DFTB+ developers group                                  #
#                                                                              #
#  See the LICENSE file for terms of usage and distribution.                   #
#------------------------------------------------------------------------------#
.SUFFIXES:
.SUFFIXES: .f .f90 .c .o

TARGETS = test_fileinit test_fileinitc test_treeinit test_extpot test_extpot2 test_extcharges \
    test_qdepextpot test_qdepextpotc

.PHONY: all
all: $(TARGETS)

include $(ROOT)/make.config

vpath % $(ROOT)/test/api/mm

INCOPTS = -I$(BUILDDIR)/api/mm -I$(BUILDDIR)/external/xmlf90
LIBOPTS = -L$(BUILDDIR)/api/mm -ldftbplus_mm -L$(BUILDDIR)/external/xmlf90 -lxmlf90
CINCOPTS = -I$(ROOT)/api/mm

%.o: %.f90
	$(FXX) $(FXXOPT) $(INCOPTS) -o $@ -c $<

%.o: %.c
	$(CC) $(CCOPT) $(CINCOPTS) -o $@ -c $<

test_fileinit: test_fileinit.o
	$(LN) $(LNOPT) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS)

test_fileinitc: test_fileinitc.o
	$(LN_C) $(LNOPT_C) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS) $(OTHERLIBS_C)

test_treeinit: test_treeinit.o
	$(LN) $(LNOPT) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS)

test_extpot: test_extpot.o extchargepot.o
	$(LN) $(LNOPT) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS)

test_extpot.o: extchargepot.o

test_extpot2: test_extpot2.o extchargepot.o
	$(LN) $(LNOPT) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS)

test_extpot2.o: extchargepot.o

test_extcharges: test_extcharges.o
	$(LN) $(LNOPT) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS)

test_qdepextpot: test_qdepextpot.o extchargepotgen.o extchargepot.o
	$(LN) $(LNOPT) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS)

test_qdepextpot.o: extchargepotgen.o extchargepot.o

test_qdepextpotc: test_qdepextpotc.o
	$(LN_C) $(LNOPT_C) -o $@ $^ $(LIBOPTS) $(LIB_LAPACK) $(OTHERLIBS) $(OTHERLIBS_C)
